# resFLARE-FLARE
Let's analyze some results generated by FLARE 🔥

* The structural details of each time step from the MD simulation resulted in cartesian coordinates of the atomic positions of the molecule. To determine different bonding parameters to characterize the molecular environment, we can use this script!

* Here we will be interested in looking at the,
  1. Bond length
     * Type of bonds
     * Minimum, maximum, and average bond distances
  3. Bond angles
  4. Dihedral angles
  5. Coordination numbers

* We are extracting bonding parameters with the use of another commercially available GitHub script, **_xyz2tab_**. To check further information on the **_xyz2tab_** script, please _**[CLICK HERE](https://github.com/radi0sus/xyz2tab.git)!**_
* Important to note that, a copy of the **_xyz2tab_** script needs to be in your file path before you can execute the following script!

> resFLARE - Step by step
1. Creating an environment suitable to perform the upcoming calculations!
   * Even though this script is written in the shell!, most of the heavy work will be done via Python-based scripts. Therefore we need to have appropriate libraries installed in the working environment.
   * Once you execute the **_resFLARE_** script, the first question that will pop up is whether you already have a suitable Python virtual environment with the libraries needed for the calculation (pandas, scipy, tabulate, matplotlib, and scikit-learn).
   * If you already have those installed, you can skip this step and move forward, or else you and ask the script to install them for you. It will generate a particular virtual environment specifically made to perform our analysis (Say YES! 👍).
3. User-defined inputs
   * The next big important thing is that the script will ask you the name of the file which contains your atomic coordinates along with the name of the molecule.
5. Dihedral angle?
   * Dihedral angle determination is user-defined, where the script will ask you whether you need to perform this extra step or not.
   * If you prefer to do some dihedral angle checking, the script will guide you to pick one from the following two options, Type 1: Atom1-Atom2-Atom3-Atom4, and Type 2: Atom1-Atom2-[...]-Atom2-Atom1.
   * After your choice, you can specify which atoms are you interested in checking the dihedral angles (ex. Au-S-C-H or C-S-[Au]-S-C).
   * Once they are done, a dihedral angle calculation will take place.
7. Coordination number of atoms
   * Coordination number will be calculated even without any specification. Where each molecular configuration will result in a specific coordination number in atom vise details.
   * However if you are intended to visualize results, you need to specify what your interests are. Therefore the script will ask you on the atom that you would like to get the coordination number and with what bonding atoms that you are looking for (for example Au-Au coordination number). 

* Once you are done with these couple of steps, we are good to go 🔥! Now the analysis has begun.

> resFLARE - Analysis

* Once the analysis is completed following will be created,

1. Folders containing the coordinates of that particular step along with a detailed representation of the bonding characteristics (Generated with the help of **_xyz2tab_**).
2. bondINFO folder: Contains three different plots based on how the minimum, maximum, and average bond distance is changed in each step with respect to all possible bonded pairs.
3. dihedralINFO folder: Contains plots that indicate how the specified dihedral angle count in each step varies. This is illustrated in two different ways, in a bar chart and using a scatter line chart, but both represent the same set of information.
4. coordINFO: Contains the plots that reflect how the specified coordination number count is varied in each step.
5. pcsINFO: This folder contains 2D and 3D principle component analysis (PCA). For the PCA all the above-mentioned bonding characteristics were used.

> Important Note

1. Each folder that was created during the analysis process will contain individual Python files, as well as the data file required to generate the graphs. Therefore, it is easy for the user to customize the Python script and elevate the visualization aspects of the graph.
2. One major thing is the 3D PCA plots would be better to visualize after the process is completed, where you can specifically tilt the direction of view and get a graph that will represent information more appealingly. An example script for the PCA plot is provided in the folder, 3D-PCA.
3. To check the script's workability, check with the example files that are provided here (check the Example folder, we have provided a **_log.lammps_** file with a coordinate file, **_test-coordinate_**).
4. The covalent radius needs to be increased to see the desired number of bonds. You can change it from the **_cov_radii_** parameter in the _**./resFLARE**_ script (at least >14% increase is encouraged), but it will mainly affected by the **_xyz2tab_** script. Please refer to [**_xyz2tab_**](https://github.com/radi0sus/xyz2tab.git)! for further information.

> Executing the Script

1. As this is a shell script, first make the script executable by, **_chmod +x resFLARE_**
2. The next step is to run the script by, _**./resFLARE**_
3. To avoid any errors, keep a copy of the **_xyz2tab_**, **_log.lammps_** file (which contains the energies in each step generated via lammps simulation) and your coordinate file within the same directory as your _**resFLARE**_ script.
